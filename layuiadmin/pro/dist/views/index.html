
<div class="layui-fluid">
  <div class="layui-row layui-col-space15">
    <div class="layui-col-md8">
      <div class="layui-row layui-col-space15">
       <!--  <div class="layui-col-md6">
          <div class="layui-card">
            <div class="layui-card-header">快捷方式</div>
            <div class="layui-card-body">
             
              <div class="layui-carousel layadmin-carousel layadmin-shortcut">
                <div carousel-item>
                  <ul class="layui-row layui-col-space10">
                      <li class="layui-col-xs3">
                        <a lay-href="home/homepage1">
                          <i class="layui-icon layui-icon-console"></i>
                          <cite>主页一</cite>
                        </a>
                      </li>
                      <li class="layui-col-xs3">
                        <a lay-href="home/homepage2">
                          <i class="layui-icon layui-icon-chart"></i>
                          <cite>主页二</cite>
                        </a>
                      </li>
                      <li class="layui-col-xs3">
                        <a lay-href="component/layer/list">
                          <i class="layui-icon layui-icon-template-1"></i>
                          <cite>弹层</cite>
                        </a>
                      </li>
                      <li class="layui-col-xs3">
                        <a lay-href="/senior/im/">
                          <i class="layui-icon layui-icon-chat"></i>
                          <cite>聊天</cite>
                        </a>
                      </li>
                      <li class="layui-col-xs3">
                        <a lay-href="component/progress/index">
                          <i class="layui-icon layui-icon-find-fill"></i>
                          <cite>进度条</cite>
                        </a>
                      </li>
                      <li class="layui-col-xs3">
                        <a lay-href="app/workorder/list">
                          <i class="layui-icon layui-icon-survey"></i>
                          <cite>工单</cite>
                        </a>
                      </li>
                      <li class="layui-col-xs3">
                        <a lay-href="user/user/list">
                          <i class="layui-icon layui-icon-user"></i>
                          <cite>用户</cite>
                        </a>
                      </li>
                      <li class="layui-col-xs3">
                        <a lay-href="set/system/website">
                          <i class="layui-icon layui-icon-set"></i>
                          <cite>设置</cite>
                        </a>
                      </li>
                    </ul>
                    <ul class="layui-row layui-col-space10">
                      <li class="layui-col-xs3">
                        <a lay-href="set/user/info">
                          <i class="layui-icon layui-icon-set"></i>
                          <cite>我的资料</cite>
                        </a>
                      </li>
                      <li class="layui-col-xs3">
                        <a lay-href="set/user/info">
                          <i class="layui-icon layui-icon-set"></i>
                          <cite>我的资料</cite>
                        </a>
                      </li>
                      <li class="layui-col-xs3">
                        <a lay-href="set/user/info">
                          <i class="layui-icon layui-icon-set"></i>
                          <cite>我的资料</cite>
                        </a>
                      </li>
                      <li class="layui-col-xs3">
                        <a lay-href="set/user/info">
                          <i class="layui-icon layui-icon-set"></i>
                          <cite>我的资料</cite>
                        </a>
                      </li>
                      <li class="layui-col-xs3">
                        <a lay-href="set/user/info">
                          <i class="layui-icon layui-icon-set"></i>
                          <cite>我的资料</cite>
                        </a>
                      </li>
                      <li class="layui-col-xs3">
                        <a lay-href="set/user/info">
                          <i class="layui-icon layui-icon-set"></i>
                          <cite>我的资料</cite>
                        </a>
                      </li>
                      <li class="layui-col-xs3">
                        <a lay-href="set/user/info">
                          <i class="layui-icon layui-icon-set"></i>
                          <cite>我的资料</cite>
                        </a>
                      </li>
                      <li class="layui-col-xs3">
                        <a lay-href="set/user/info">
                          <i class="layui-icon layui-icon-set"></i>
                          <cite>我的资料</cite>
                        </a>
                      </li>
                    </ul>
                  
                </div>
              </div>
              
            </div>
          </div>
        </div>-->
        
       <!--  <div class="layui-col-md6">
          <div class="layui-card">
            <div class="layui-card-header">待办事项</div>
            <div class="layui-card-body">

              <div class="layui-carousel layadmin-carousel layadmin-backlog">
                <div carousel-item>
                  <ul class="layui-row layui-col-space10">
                    <li class="layui-col-xs6">
                      <a lay-href="app/content/comment"  class="layadmin-backlog-body">
                        <h3>待审评论</h3>
                        <p><cite><span id="test2">696</span></cite></p>
                      </a>
                    </li>
                    <li class="layui-col-xs6">
                      <a lay-href="app/forum/list" class="layadmin-backlog-body">
                        <h3>待审帖子</h3>
                        <p><cite>12</cite></p>
                      </a>
                    </li>
                    <li class="layui-col-xs6">
                      <a lay-href="template/goodslist" class="layadmin-backlog-body">
                        <h3>待审商品</h3>
                        <p><cite>99</cite></p>
                      </a>
                    </li>
                    <li class="layui-col-xs6">
                      <a href="javascript:;" onclick="layer.tips('不跳转', this, {tips: 3});" class="layadmin-backlog-body">
                        <h3>待发货</h3>
                        <p><cite>20</cite></p>
                      </a>
                    </li>
                  </ul>
                  <ul class="layui-row layui-col-space10">
                    <li class="layui-col-xs6">
                      <a href="javascript:;" class="layadmin-backlog-body">
                        <h3>待审友情链接</h3>
                        <p><cite style="color: #FF5722;">5</cite></p>
                      </a>
                    </li>
                  </ul>
                </div>
              </div>
            </div>
          </div>
        </div>-->
        <div class="layui-col-md12">
          <div class="layui-card">
            <div class="layui-card-header">今日数据概览</div>
            <div class="layui-card-body">
              
              <div class="layui-carousel layadmin-carousel layadmin-dataview" data-anim="fade" lay-filter="LAY-index-dataview">
                <div carousel-item id="LAY-index-dataview">
                  <div><i class="layui-icon layui-icon-loading1 layadmin-loading"></i></div>
                  <!--<div></div>-->
                  <div></div>
                </div>
              </div>
              
            </div>
          </div>
          <!--
          <div class="layui-card">
            <div class="layui-card-header">访客地区分布</div>
            <div class="layui-card-body">
              <div class="layui-row layui-col-space15">
                <div class="layui-col-sm4">
                  <table class="layui-table layuiadmin-page-table" lay-skin="line">
                      <thead>
                        <tr>
                          <th>排名</th>
                          <th>地区</th>
                          <th>人数</th>
                        </tr> 
                      </thead>
                      <tbody>
                        <tr>
                          <td>1</td>
                          <td>浙江</td>
                          <td>62310</td>
                        </tr>
                        <tr>
                          <td>2</td>
                          <td>上海</td>
                          <td>59190</td>
                        </tr>
                        <tr>
                          <td>3</td>
                          <td>广东</td>
                          <td>55891</td>
                        </tr>
                        <tr>
                          <td>4</td>
                          <td>北京</td>
                          <td>51919</td>
                        </tr>  
                        <tr>
                          <td>5</td>
                          <td>山东</td>
                          <td>39231</td>
                        </tr>
                        <tr>
                          <td>6</td>
                          <td>湖北</td>
                          <td>37109</td>
                        </tr>
                      </tbody>
                    </table>
                </div>
                <div class="layui-col-sm8">
                  <div class="layui-carousel layadmin-carousel layadmin-dataview" data-anim="fade" lay-filter="LAY-index-pagethree-home">
                    <div carousel-item id="LAY-index-pagethree-home">
                      <div><i class="layui-icon layui-icon-loading1 layadmin-loading"></i></div>
                    </div>
                  </div>    
                </div>
              </div>
            </div>
          </div>-->
          
          <div class="layui-card">
          	<!--<div class="layui-card-header">今日运营数据（可自定义）</div>-->
            <div class="layui-tab layui-tab-brief layadmin-latestData"  lay-filter="tab-title">
              <ul class="layui-tab-title" >
                <li class="layui-hide"  id="title0">0<span class="layui-badge">6888</span></li>
                <li class="layui-hide"  id="title1">1</li>
                <li class="layui-hide"  id="title2">2</li>
                <li class="layui-hide"  id="title3">3</li>
                <li class="layui-hide"  id="title4">4</li>
                <li class="layui-hide"  id="title5">5</li>
                <li class="layui-hide"  id="title6">6</li>
                <li class="layui-hide"  id="title7">7</li>
              </ul>
              <div class="layui-tab-content" >
                <div class="layui-tab-item layui-show" id="tab-item0">
                  <table id="table0"></table>
                </div>
                
                <div class="layui-tab-item"  id="tab-item1">
                  <table id="table1"></table>
                </div>
                
                 <div class="layui-tab-item"  id="tab-item2">
                  <table id="table2"></table>
                </div>
                
                <div class="layui-tab-item"  id="tab-item3">
                  <table id="table3"></table>
                </div>
                
                <div class="layui-tab-item" id="tab-item4">
                  <table id="table4"></table>
                </div>
                
                <div class="layui-tab-item"  id="tab-item5">
                  <table id="table5"></table>
                </div>
                
                 <div class="layui-tab-item"  id="tab-item6">
                  <table id="table6"></table>
                </div>
                
                <div class="layui-tab-item"  id="tab-item7">
                  <table id="table7"></table>
                </div>
                
               
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    
    
       <div class="layui-col-md4">
          <div class="layui-card">
            <div class="layui-card-header">今日运营数据</div>
            <div class="layui-card-body">

              <div class="layui-carousel layadmin-carousel layadmin-dataview layadmin-backlog">
                <div carousel-item>
                  <ul class="layui-row layui-col-space10">
                    <li class="layui-col-xs6">
                      <a lay-href="stat0"  class="layadmin-backlog-body">
                        <h3 id="label0">--</h3>
                        <p><cite><span id="lcount0">0</span></cite></p>
                      </a>
                    </li>
                    <li class="layui-col-xs6">
                      <a lay-href="stat1" class="layadmin-backlog-body">
                        <h3 id="label1">--</h3>
                       <p><cite><span id="lcount1">0</span></cite></p>
                      </a>
                    </li>
                    <li class="layui-col-xs6">
                      <a lay-href="stat2" class="layadmin-backlog-body">
                        <h3 id="label2">--</h3>
                        <p><cite><span id="lcount2">0</span></cite></p>
                      </a>
                    </li>
                    <li class="layui-col-xs6">
                      <a lay-href="stat3" class="layadmin-backlog-body">
                        <h3 id="label3">--</h3>
                        <p><cite><span id="lcount3">0</span></cite></p>
                      </a>
                    </li>
                     <li class="layui-col-xs6">
                      <a lay-href="flux" class="layadmin-backlog-body">
                        <h3 id="label4">IP数量</h3>
                        <p><cite><span id="lcount4">0</span></cite></p>
                      </a>
                    </li>
                    <li class="layui-col-xs6">
                      <a lay-href="flux" class="layadmin-backlog-body">
                        <h3 id="label5">流量</h3>
                        <p><cite><span id="lcount5">0</span></cite></p>
                      </a>
                    </li>
                    
                  </ul>
                  <!--<ul class="layui-row layui-col-space10">
                    <li class="layui-col-xs6">
                      <a href="javascript:;" class="layadmin-backlog-body">
                        <h3>待审友情链接</h3>
                        <p><cite style="color: #FF5722;">5</cite></p>
                      </a>
                    </li>
                  </ul>-->
                </div>
              </div>
            </div>
          </div>
        </div>
    
    <div class="layui-col-md4">     
    	
    	<div class="layui-card">
        <div class="layui-card-header">AI风控监测</div>
        <div class="layui-card-body" style="padding: 22px 15px;">
          <table id="LAY-home-homepage-console"></table>
        </div>
      </div>
      
      
      <!--<div class="layui-card">
        <div class="layui-card-header">效果报告</div>
        <div class="layui-card-body layadmin-takerates">
          <div class="layui-progress" lay-showPercent="yes">
            <h3>转化率（日同比 28% <span class="layui-edge layui-edge-top" lay-tips="增长" lay-offset="-15"></span>）</h3>
            <div class="layui-progress-bar" lay-percent="65%"></div>
          </div>
          <div class="layui-progress" lay-showPercent="yes">
            <h3>签到率（日同比 11% <span class="layui-edge layui-edge-bottom" lay-tips="下降" lay-offset="-15"></span>）</h3>
            <div class="layui-progress-bar" lay-percent="32%"></div>
          </div>
        </div>
      </div>-->
      
      <div class="layui-card">
        <div class="layui-card-header">系统状态</div>
        <div class="layui-card-body layadmin-takerates">
          <div class="layui-progress" lay-filter="cpu" lay-showPercent="yes">
            <h3>CPU使用率</h3>
            <div class="layui-progress-bar"  lay-percent="0%"></div>
          </div>
          
          <div class="layui-progress" lay-filter="disk" lay-showPercent="yes">
            <h3>磁盘使用率</h3>
            <div class="layui-progress-bar"  lay-percent="0%"></div>
          </div>
          
          <div class="layui-progress" lay-filter="mem" lay-showPercent="yes">
            <h3>内存占用率</h3>
            <div class="layui-progress-bar" lay-percent="0%"></div>
          </div>
          
           
          
        </div>
      </div>
      

     

      
    </div>
    
  </div>
</div>

 <script src="util.js"> </script>
 <script src="d3.js"> </script>

<script>
	var layer = layui.layer;
	var $ = jQuery = layui.jquery;
	var  element = layui.element;
	$(".layui-badge").html("8888");
	
	//隐藏菜单
  var bl = $("#LAY_app_flexible").hasClass("layui-icon-shrink-right");
  if (bl) {
     // $("#LAY_app_flexible").click();
  }

	
	$("#label4").html("IP数量");
	
	var token = CoreUtil.getStok("token");
	if (token == undefined || token == null || token.length < 32 )
	    token = "12345678123456781234567812345678";
	    
	layui.use(['admin', 'form', 'user'], function(){  	  
	  if (token.length > 31) {
		  layui.data(layui.setter.tableName, {
		          key: layui.setter.request.tokenName
		          ,value: token
		  });
	  }	
  });
        	
	function abc() {
	    CoreUtil.sendAjax("/bigdata/table0.json?token=" + token,null,function (res) {	    
	    	
	    	  if(res.systemstat != null){ 
            	  element.progress('cpu', res.systemstat[0] +'%');
            	  element.progress('disk', res.systemstat[1] +'%');
            	  element.progress('mem', res.systemstat[2] +'%');       
            	  element.render('cpu');     	
            }	   
	    	    
	    	    if (res.tab != null && res.tabnum) {
	    	    	 res.tab.forEach(function(value,i){
	    	    	 	   $("#title" + i).html(res.tab[i]+ '<span class="layui-badge">'+ res.tabnum[i] +'</span>'); 
	    	    	 	   if (res.tab[i] != 'hide')		
	    	    	 	       $("#title" + i).removeClass("layui-hide");	    	              	    
            	 });            	 
            	
            }
            
            if (res.data != null){  
                loadTable("/bigdata/table0.json?token=" + token ,"#table0",res.data,res.title);          
            }
            
          
            
           if (res.label != null && res.lcount != null){  
           	    res.label.forEach(function(value,i){
	    	    	 	   $("#label" + i).html(res.label[i]); 	
	    	    	 	   $("#lcount" + i).html(res.lcount[i]); 	
	    	    	 	                	    
            	 });    
                    
            }
            
      },"GET",false);
	}
	

	abc();
	//setInterval(abc,300000);

//加载 controller 目录下的对应模块
/*

  小贴士：
    这里 console 模块对应 的 console.js 并不会重复加载，
    然而该页面的视图则是重新插入到容器，那如何保证能重新来控制视图？有两种方式：
      1): 借助 layui.factory 方法获取 console 模块的工厂（回调函数）给 layui.use
      2): 直接在 layui.use 方法的回调中书写业务代码，即:
          layui.use('console', function(){ 
            //同 console.js 中的 layui.define 回调中的代码 
          });
          
  这里我们采用的是方式1。其它很多视图中采用的其实都是方式2，因为更简单些，也减少了一个请求数。
  
*/
layui.use('console', layui.factory('console'));

        
  //$(".layui-tab-title").append("<li>shit</li>");
  //$(".layui-tab-content").append("<div class=\"layui-tab-item\"  id=\"table3\">   <table id=\"LAY-index-topCard\"></table>  </div>");
                
	element.on('tab(tab-title11)', function(data){
	   
	
		var e = (layui.$, layui.table);
		var mt =  Date.parse(new Date());
		var myurl = "abc.json?" + mt /1000;
		var myelem = "#LAY-index-topSearch"
		
		    myurl = "/bigdata/table" + data.index + ".json?token=" + token + mt /1000;
		    myelem = "#table" + data.index;
		    
		    $(function () {
	          CoreUtil.sendAjax(myurl,null,function (res) {
            if(res.data != null){            
             
               loadTable(myurl,myelem,res.data,res.title);
          
            }
           },"GET",false);
	      });
	
		//alert(myurl);
		/*e.render({
			elem: myelem,
			url: myurl,
			page: !0,
			cols: [[{
				type: "numbers",
				fixed: "left"
			},
			{
				field: "time",
				title: "时间",
				sort: !0,
				minWidth: 80,
				templet: '<div><a href="https://www.baidu.com/s?wd={{ d.time }}" target="_blank" class="layui-table-link">{{ d.time }}</div>'
			},
			{
				field: "src_ip",
				title: "IP地址",
				minWidth: 80,
				sort: !0
			},
			{
				field: "geoip",
				title: "地理位置",
				minWidth: 80,
				sort: !0
			},
			{
				field: "content1",
				title: "用户名",
				minWidth: 100			
			},
			{
				field: "content2",
				title: "密码",
				minWidth: 100			
			},
			{
				field: "content3",
				title: "状态"	
				
			}]],
			skin: "line"
		});*/
		

  	});
  	

	var table = (layui.$, layui.table);
	//渲染table
  var loadTable = function (myurl,myelem,data,title) {    
      var content="content1";
      var j = 0;
      var cols_arr=new Array();
      
      cols_arr[0] = [];
      cols_arr[0][0] = {type: "numbers",fixed: "left"};
      cols_arr[0][1] = {field: "time",title: "时间",sort: !0,	minWidth: 100};			
      cols_arr[0][2] = {field: "src_ip",title: "IP地址",minWidth: 100,	sort: !0,
				  templet: '<div><a href="/webpages/index.html?trace-log&sip={{ d.src_ip }}" target="_blank" class="layui-table-link">{{ d.src_ip }}</div>'
      	};
      cols_arr[0][3] = {field: "geoip",title: "地理位置",minWidth: 100};  
     // cols_arr[0][4] = {field: "content1",title: "--",minWidth: 100};  
     // cols_arr[0][5] = {field: "content2",title: "--",minWidth: 100};  
     // cols_arr[0][6] = {field: "content3",title: "--",minWidth: 100};      


      title.forEach(function(value,i){
            if (title[i].length != 0) {
            	 content = "content" + (i + 1);
            	 j++;              
            	 cols_arr[0][3+j] = {field:content, title: title[i], minWidth: 100};                           
            }
              
      });
      
   
      
      table.render({
                elem: myelem
                ,url: myurl
                ,page: !0
                ,cellMinWidth: 120
                ,height: '485'
                , cols: cols_arr
                ,skin: "line"               
            });
            
      //cols_arr.length = 0;
  };
        


</script>

