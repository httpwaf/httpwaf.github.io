<div class="layui-fluid">
  <div class="layui-row layui-col-space15">
    <div class="layui-col-md8">
      <div class="layui-row layui-col-space15">
       <!--  <div class="layui-col-md6">
          <div class="layui-card">
            <div class="layui-card-header">快捷方式</div>
            <div class="layui-card-body">
             
              <div class="layui-carousel layadmin-carousel layadmin-shortcut">
                <div carousel-item>
                  <ul class="layui-row layui-col-space10">
                      <li class="layui-col-xs3">
                        <a lay-href="home/homepage1">
                          <i class="layui-icon layui-icon-console"></i>
                          <cite>主页一</cite>
                        </a>
                      </li>
                      <li class="layui-col-xs3">
                        <a lay-href="home/homepage2">
                          <i class="layui-icon layui-icon-chart"></i>
                          <cite>主页二</cite>
                        </a>
                      </li>
                      <li class="layui-col-xs3">
                        <a lay-href="component/layer/list">
                          <i class="layui-icon layui-icon-template-1"></i>
                          <cite>弹层</cite>
                        </a>
                      </li>
                      <li class="layui-col-xs3">
                        <a lay-href="/senior/im/">
                          <i class="layui-icon layui-icon-chat"></i>
                          <cite>聊天</cite>
                        </a>
                      </li>
                      <li class="layui-col-xs3">
                        <a lay-href="component/progress/index">
                          <i class="layui-icon layui-icon-find-fill"></i>
                          <cite>进度条</cite>
                        </a>
                      </li>
                      <li class="layui-col-xs3">
                        <a lay-href="app/workorder/list">
                          <i class="layui-icon layui-icon-survey"></i>
                          <cite>工单</cite>
                        </a>
                      </li>
                      <li class="layui-col-xs3">
                        <a lay-href="user/user/list">
                          <i class="layui-icon layui-icon-user"></i>
                          <cite>用户</cite>
                        </a>
                      </li>
                      <li class="layui-col-xs3">
                        <a lay-href="set/system/website">
                          <i class="layui-icon layui-icon-set"></i>
                          <cite>设置</cite>
                        </a>
                      </li>
                    </ul>
                    <ul class="layui-row layui-col-space10">
                      <li class="layui-col-xs3">
                        <a lay-href="set/user/info">
                          <i class="layui-icon layui-icon-set"></i>
                          <cite>我的资料</cite>
                        </a>
                      </li>
                      <li class="layui-col-xs3">
                        <a lay-href="set/user/info">
                          <i class="layui-icon layui-icon-set"></i>
                          <cite>我的资料</cite>
                        </a>
                      </li>
                      <li class="layui-col-xs3">
                        <a lay-href="set/user/info">
                          <i class="layui-icon layui-icon-set"></i>
                          <cite>我的资料</cite>
                        </a>
                      </li>
                      <li class="layui-col-xs3">
                        <a lay-href="set/user/info">
                          <i class="layui-icon layui-icon-set"></i>
                          <cite>我的资料</cite>
                        </a>
                      </li>
                      <li class="layui-col-xs3">
                        <a lay-href="set/user/info">
                          <i class="layui-icon layui-icon-set"></i>
                          <cite>我的资料</cite>
                        </a>
                      </li>
                      <li class="layui-col-xs3">
                        <a lay-href="set/user/info">
                          <i class="layui-icon layui-icon-set"></i>
                          <cite>我的资料</cite>
                        </a>
                      </li>
                      <li class="layui-col-xs3">
                        <a lay-href="set/user/info">
                          <i class="layui-icon layui-icon-set"></i>
                          <cite>我的资料</cite>
                        </a>
                      </li>
                      <li class="layui-col-xs3">
                        <a lay-href="set/user/info">
                          <i class="layui-icon layui-icon-set"></i>
                          <cite>我的资料</cite>
                        </a>
                      </li>
                    </ul>
                  
                </div>
              </div>
              
            </div>
          </div>
        </div>-->
        
       <!--  <div class="layui-col-md6">
          <div class="layui-card">
            <div class="layui-card-header">待办事项</div>
            <div class="layui-card-body">

              <div class="layui-carousel layadmin-carousel layadmin-backlog">
                <div carousel-item>
                  <ul class="layui-row layui-col-space10">
                    <li class="layui-col-xs6">
                      <a lay-href="app/content/comment"  class="layadmin-backlog-body">
                        <h3>待审评论</h3>
                        <p><cite><span id="test2">696</span></cite></p>
                      </a>
                    </li>
                    <li class="layui-col-xs6">
                      <a lay-href="app/forum/list" class="layadmin-backlog-body">
                        <h3>待审帖子</h3>
                        <p><cite>12</cite></p>
                      </a>
                    </li>
                    <li class="layui-col-xs6">
                      <a lay-href="template/goodslist" class="layadmin-backlog-body">
                        <h3>待审商品</h3>
                        <p><cite>99</cite></p>
                      </a>
                    </li>
                    <li class="layui-col-xs6">
                      <a href="javascript:;" onclick="layer.tips('不跳转', this, {tips: 3});" class="layadmin-backlog-body">
                        <h3>待发货</h3>
                        <p><cite>20</cite></p>
                      </a>
                    </li>
                  </ul>
                  <ul class="layui-row layui-col-space10">
                    <li class="layui-col-xs6">
                      <a href="javascript:;" class="layadmin-backlog-body">
                        <h3>待审友情链接</h3>
                        <p><cite style="color: #FF5722;">5</cite></p>
                      </a>
                    </li>
                  </ul>
                </div>
              </div>
            </div>
          </div>
        </div>-->
        <div class="layui-col-md12">
          <div class="layui-card">
            <div class="layui-card-header">一月数据趋势</div>
            <div class="layui-card-body">
              
              <div class="layui-carousel layadmin-carousel layadmin-dataview" data-anim="fade" lay-filter="LAY-index-dataview">
                <div carousel-item id="LAY-index-dataview">
                  <div><i class="layui-icon layui-icon-loading1 layadmin-loading"></i></div>
                  <!--<div></div>-->
                  <div></div>
                </div>
              </div>
              
            </div>
          </div>
          <!--
          <div class="layui-card">
            <div class="layui-card-header">访客地区分布</div>
            <div class="layui-card-body">
              <div class="layui-row layui-col-space15">
                <div class="layui-col-sm4">
                  <table class="layui-table layuiadmin-page-table" lay-skin="line">
                      <thead>
                        <tr>
                          <th>排名</th>
                          <th>地区</th>
                          <th>人数</th>
                        </tr> 
                      </thead>
                      <tbody>
                        <tr>
                          <td>1</td>
                          <td>浙江</td>
                          <td>62310</td>
                        </tr>
                        <tr>
                          <td>2</td>
                          <td>上海</td>
                          <td>59190</td>
                        </tr>
                        <tr>
                          <td>3</td>
                          <td>广东</td>
                          <td>55891</td>
                        </tr>
                        <tr>
                          <td>4</td>
                          <td>北京</td>
                          <td>51919</td>
                        </tr>  
                        <tr>
                          <td>5</td>
                          <td>山东</td>
                          <td>39231</td>
                        </tr>
                        <tr>
                          <td>6</td>
                          <td>湖北</td>
                          <td>37109</td>
                        </tr>
                      </tbody>
                    </table>
                </div>
                <div class="layui-col-sm8">
                  <div class="layui-carousel layadmin-carousel layadmin-dataview" data-anim="fade" lay-filter="LAY-index-pagethree-home">
                    <div carousel-item id="LAY-index-pagethree-home">
                      <div><i class="layui-icon layui-icon-loading1 layadmin-loading"></i></div>
                    </div>
                  </div>    
                </div>
              </div>
            </div>
          </div>-->
          
     <div class="layui-card">
      <div class="layui-form layui-card-header layuiadmin-card-header-auto" lay-filter="app-content-list">
        <div class="layui-form-item">
          <div class="layui-inline">
            <label class="layui-form-label">日期</label>
            <div class="layui-input-inline">
              <input type="text" name="date" id="date" placeholder="可不选" class="layui-input">
            </div>
          </div>
          <div class="layui-inline">
            <label class="layui-form-label">IP</label>
            <div class="layui-input-inline">
              <input type="text" name="ip" id="ip" placeholder="可不填" autocomplete="off" class="layui-input">
            </div>
          </div>
          <div class="layui-inline">
            <label class="layui-form-label">内容</label>
            <div class="layui-input-inline">
              <input type="text" name="content" id="content" placeholder="可不填" autocomplete="off" class="layui-input">
            </div>
          </div>
         
          <div class="layui-inline">
            <button class="layui-btn layuiadmin-btn-list" lay-submit lay-filter="LAY-app-contlist-search">
              <i class="layui-icon layui-icon-search layuiadmin-button-btn"></i>
            </button>
          </div>
        </div>
      </div>

      <div class="layui-card-body">    
        <table id="LAY-app-content-list" lay-filter="LAY-app-content-list"></table>         
      </div>
    </div>
    
          
        </div>
      </div>
    </div>
    
    
     <div class="layui-col-md4">
     	       	
       	<div class="layui-card">
        <div class="layui-card-header">十大IP排行图</div>
        <div class="layui-card-body">
          
          <div class="layui-carousel layadmin-carousel layadmin-dataview" data-anim="fade" lay-filter="LAY-index-normbar">
            <div carousel-item id="LAY-index-normbar">
              <div><i class="layui-icon layui-icon-loading1 layadmin-loading"></i></div>
            </div>
          </div>

       </div>
       </div>       
          
     </div>
     
    
    <div class="layui-col-md4">     
    	
    	<div class="layui-card">
        <div class="layui-card-header">十大IP列表</div> 
        <div class="layui-card-body" style="padding: 48px 15px;">
          <table id="LAY-home-homepage-console"></table>
        </div>
      </div>
      
      
      <!--<div class="layui-card">
        <div class="layui-card-header">效果报告</div>
        <div class="layui-card-body layadmin-takerates">
          <div class="layui-progress" lay-showPercent="yes">
            <h3>转化率（日同比 28% <span class="layui-edge layui-edge-top" lay-tips="增长" lay-offset="-15"></span>）</h3>
            <div class="layui-progress-bar" lay-percent="65%"></div>
          </div>
          <div class="layui-progress" lay-showPercent="yes">
            <h3>签到率（日同比 11% <span class="layui-edge layui-edge-bottom" lay-tips="下降" lay-offset="-15"></span>）</h3>
            <div class="layui-progress-bar" lay-percent="32%"></div>
          </div>
        </div>
      </div>
      
      <div class="layui-card">
        <div class="layui-card-header">系统状态</div>
        <div class="layui-card-body layadmin-takerates">
          <div class="layui-progress" lay-filter="cpu" lay-showPercent="yes">
            <h3>CPU使用率</h3>
            <div class="layui-progress-bar"  lay-percent="68%"></div>
          </div>
          
          <div class="layui-progress" lay-filter="disk" lay-showPercent="yes">
            <h3>磁盘使用率</h3>
            <div class="layui-progress-bar"  lay-percent="68%"></div>
          </div>
          
          <div class="layui-progress" lay-filter="mem" lay-showPercent="yes">
            <h3>内存占用率</h3>
            <div class="layui-progress-bar" lay-percent="90%"></div>
          </div>
          
           
          
        </div>
      </div>-->
      

     

      
    </div>
    
  </div>
</div>

 <script src="util.js"> </script>

<script type="text/javascript">
	var layer = layui.layer;
	var $ = jQuery = layui.jquery;
	var  element = layui.element;
  var form = layui.form;
  var topx =[];
  var topy = [];
  var x2data = [];
  var y2data = []; 
   
  var id =  getid(); alert(id);  

  var tablename = "/bigdata/table" + id  + ".json";	    
 
  
  
  function getid() { 
  	 
  	 var   str = "abcdefgh" + window.location;
     var   i = str.indexOf("aatable");
     
     if   (i < 0)
           return "0";
                      
     var   out = str.substr(i + 5,1);
           return out;
  }
 
  	    
  function GetQueryString(name) { 
     var reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)","i"); 
     var r = window.location.search.substr(1).match(reg); 
     if (r!=null) return (r[2]); return null; 
  } 
    
  form.render(null, 'app-content-list');
  //搜索
  form.on('submit(LAY-app-contlist-search)', function(data){
      var field = data.field;
      
      //执行重载
      table.reload('LAY-app-content-list', {
        where: field
      });      
      
      if ($("#date").val() != "") {      
          window.location.reload();
      }
    });
	

	function abc() {
	    CoreUtil.sendAjax(tablename,null,function (res) {	
	               
            if (res.data != null){  
            	  loadTop();
            	  
                loadTable(tablename,"#LAY-app-content-list",res.data,res.title);  
                  
                table.reload('LAY-home-homepage-console', {
                    elem: '#LAY-home-homepage-console'
                    ,data: res.top10
                });
                 
                topx = res.topx;
                topy = res.topy; 
            }  
            
            if (res.x2data != null){  
            	  x2data = res.x2data;
            }   
            
             if (res.y2data != null){  
            	  y2data = res.y2data;
            }                  

            
      },"GET",false);
	}
	

	//abc();
	//setInterval(abc,300000);


  layui.use('yunying', layui.factory('yunying'));

	var table = (layui.$, layui.table);
	//渲染table
  var loadTable = function (myurl,myelem,data,title) {    
      var content="content1";
      var j = 0;
      var cols_arr=new Array();
      
      cols_arr[0] = [];
      cols_arr[0][0] = {type: "numbers",fixed: "left"};
      cols_arr[0][1] = {
				  field: "time",title: "时间",sort: !0,	minWidth: 100				  
			};			
      cols_arr[0][2] = {field: "src_ip",title: "IP地址",minWidth: 100,	sort: !0,
      	  templet: '<div><a href="https://www.baidu.com/s?wd={{ d.src_ip }}" target="_blank" class="layui-table-link">{{ d.src_ip }}</div>' 
      	};
      cols_arr[0][3] = {field: "geoip",title: "地理位置",minWidth: 100};   

      title.forEach(function(value,i){
            if (title[i].length != 0) {
            	 content = "content" + (i + 1);
            	 j++;              
            	 cols_arr[0][3+j] = {field:content, title: title[i], minWidth: 100};                           
            }
              
      });
      
   
      
      table.render({
                elem: myelem
                ,url: myurl             
                ,page: !0
                ,cellMinWidth: 120
                , cols: cols_arr
                ,skin: "line"               
            });
            
      //cols_arr.length = 0;
  };

  
   var loadTop = function () {  
      
      table.render({
                elem: "#LAY-home-homepage-console",             
	              data:[],
		            cols: [[
								{
									type: "numbers",
									fixed: "left",
									width: 50
								},
								{
									field: "src_ip",
									title: "IP地址",
									width: 150
								},
								{
									field: "geoip",
									title: "地理位置",			
								},
								{
									field: "count",
									title: "访问次数",			
								}/*,
								{
									field: "risk",
									title: "风险等级",
									width: 60,
									templet: function(e) {
										return "中" == e.risk ? '<del style="color: #5FB878;">' + e.risk + "</del>": "高" == e.risk ? '<span style="color: #FFB800;">' + 
										       e.risk + "</span>": '<span style="color: #FF5722;">' + e.risk + "</span>"
									}
								}*/]],
								skin: "line"          
    });
            
   
  };
     
        


</script>

